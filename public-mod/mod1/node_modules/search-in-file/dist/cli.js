#!/usr/bin/env node
"use strict";
var _a;
Object.defineProperty(exports, "__esModule", { value: true });
const commander_1 = require("commander");
const _1 = require(".");
function concatValues(value, previous) {
    return previous.concat([value]);
}
const program = new commander_1.Command('search-in-file')
    .version('3.5.2')
    .arguments('<text-to-search>')
    .usage('<text-to-search> [options]')
    .action((text) => {
    program.textToSearch = text;
})
    .on('--help', () => {
    console.log();
    console.log('Only <text-to-search> is required');
})
    .option('-p, --path <path>', 'Path(s) of file/directory to search. Default: Current working directory', concatValues, [])
    .option('-w, --word', 'Search for exact word?', false)
    .option('-i, --ignore-case', 'Ignore case while searching?', false)
    .option('--reg', `Consider "text-to-search" as regex?`, false)
    .option('-r, --recursive', `Search recursively in sub-directories of a directory`, false)
    .option('-e, --exclude-dir <exclude-dir>', 'Directory/file(s) to exclude while searching', concatValues, [])
    .option('-f, --file-mask <file-mask>', `Search in files with specific extension. Example: ".txt", ".js"`)
    .option('-s, --search-results <type>', `Type of search result. "filePaths"/"lineNo". Default: filePaths`, 'filePaths');
program.parse(process.argv);
if (!program.textToSearch) {
    console.log();
    console.error('Please specify the text to search:');
    console.log(`\t${program.name()} <text-to-search>`);
    console.log();
    console.log('For example:');
    console.log(`\t${program.name()} hello`);
    console.log();
    console.log(`Run search-in-file --help to see all options.`);
    process.exit(1);
}
const textToSearch = program.textToSearch;
const searchResults = program.getOptionValue('searchResults');
const paths = !((_a = program.getOptionValue('path')) === null || _a === void 0 ? void 0 : _a.length) ? [process.cwd()] : program.getOptionValue('path');
if (searchResults && searchResults !== 'filePaths' && searchResults !== 'lineNo') {
    console.log("Invalid value for argument '--search-results'");
    console.log();
    console.log(`Run search-in-file --help to see all options.`);
    process.exit(1);
}
const options = {
    words: program.getOptionValue('word'),
    ignoreCase: program.getOptionValue('ignoreCase'),
    isRegex: program.getOptionValue('reg'),
    recursive: program.getOptionValue('recursive'),
    ignoreDir: program.getOptionValue('excludeDir'),
    fileMask: program.getOptionValue('fileMask'),
    searchResults: program.getOptionValue('searchResults'),
};
(0, _1.fileSearch)(paths, textToSearch, options)
    .then((res) => {
    if (!res.length) {
        throw new Error('No results found.');
    }
    if (program.searchResults === 'lineNo') {
        res.forEach((r) => {
            if (r.length) {
                const [firstElem] = r;
                console.log();
                console.log(`filePath: ${firstElem.filePath}`);
                console.table(r, ['line', 'lineNo']);
            }
        });
    }
    else {
        console.table(res);
    }
})
    .catch((err) => {
    console.log(err);
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2xpLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL2NsaS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBRUEseUNBQW9DO0FBRXBDLHdCQUErQjtBQUUvQixTQUFTLFlBQVksQ0FBQyxLQUFhLEVBQUUsUUFBa0I7SUFDckQsT0FBTyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztBQUNsQyxDQUFDO0FBRUQsTUFBTSxPQUFPLEdBVVQsSUFBSSxtQkFBTyxDQUFDLGdCQUFnQixDQUFDO0tBQzlCLE9BQU8sQ0FBQyxPQUFPLENBQUM7S0FDaEIsU0FBUyxDQUFDLGtCQUFrQixDQUFDO0tBQzdCLEtBQUssQ0FBQyw0QkFBNEIsQ0FBQztLQUNuQyxNQUFNLENBQUMsQ0FBQyxJQUFJLEVBQUUsRUFBRTtJQUNmLE9BQU8sQ0FBQyxZQUFZLEdBQUcsSUFBSSxDQUFDO0FBQzlCLENBQUMsQ0FBQztLQUNELEVBQUUsQ0FBQyxRQUFRLEVBQUUsR0FBRyxFQUFFO0lBQ2pCLE9BQU8sQ0FBQyxHQUFHLEVBQUUsQ0FBQztJQUNkLE9BQU8sQ0FBQyxHQUFHLENBQUMsbUNBQW1DLENBQUMsQ0FBQztBQUNuRCxDQUFDLENBQUM7S0FDRCxNQUFNLENBQ0wsbUJBQW1CLEVBQ25CLHlFQUF5RSxFQUN6RSxZQUFZLEVBQ1osRUFBRSxDQUNIO0tBQ0EsTUFBTSxDQUFDLFlBQVksRUFBRSx3QkFBd0IsRUFBRSxLQUFLLENBQUM7S0FDckQsTUFBTSxDQUFDLG1CQUFtQixFQUFFLDhCQUE4QixFQUFFLEtBQUssQ0FBQztLQUNsRSxNQUFNLENBQUMsT0FBTyxFQUFFLHFDQUFxQyxFQUFFLEtBQUssQ0FBQztLQUM3RCxNQUFNLENBQ0wsaUJBQWlCLEVBQ2pCLHNEQUFzRCxFQUN0RCxLQUFLLENBQ047S0FDQSxNQUFNLENBQ0wsaUNBQWlDLEVBQ2pDLDhDQUE4QyxFQUM5QyxZQUFZLEVBQ1osRUFBRSxDQUNIO0tBQ0EsTUFBTSxD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Q0FBQyxHQUFHLEVBQUUsQ0FBQztnQkFDZCxPQUFPLENBQUMsR0FBRyxDQUFDLGFBQWEsU0FBUyxDQUFDLFFBQVEsRUFBRSxDQUFDLENBQUM7Z0JBQy9DLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLENBQUMsTUFBTSxFQUFFLFFBQVEsQ0FBQyxDQUFDLENBQUM7WUFDdkMsQ0FBQztRQUNILENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztTQUFNLENBQUM7UUFDTixPQUFPLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ3JCLENBQUM7QUFDSCxDQUFDLENBQUM7S0FDRCxLQUFLLENBQUMsQ0FBQyxHQUFVLEVBQUUsRUFBRTtJQUNwQixPQUFPLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQ25CLENBQUMsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiIyEvdXNyL2Jpbi9lbnYgbm9kZVxyXG5cclxuaW1wb3J0IHsgQ29tbWFuZCB9IGZyb20gJ2NvbW1hbmRlcic7XHJcbmltcG9ydCB7IExpbmVSZXN1bHQsIFNlYXJjaFJlc3VsdHMgfSBmcm9tICcuL3R5cGVzJztcclxuaW1wb3J0IHsgZmlsZVNlYXJjaCB9IGZyb20gJy4nO1xyXG5cclxuZnVuY3Rpb24gY29uY2F0VmFsdWVzKHZhbHVlOiBzdHJpbmcsIHByZXZpb3VzOiBzdHJpbmdbXSkge1xyXG4gIHJldHVybiBwcmV2aW91cy5jb25jYXQoW3ZhbHVlXSk7XHJcbn1cclxuXHJcbmNvbnN0IHByb2dyYW06IENvbW1hbmQgJiB7XHJcbiAgdGV4dFRvU2VhcmNoPzogc3RyaW5nO1xyXG4gIHBhdGg/OiBzdHJpbmdbXTtcclxuICBzZWFyY2hSZXN1bHRzPzogU2VhcmNoUmVzdWx0cztcclxuICBmaWxlTWFzaz86IHN0cmluZztcclxuICBleGNsdWRlRGlyPzogc3RyaW5nW107XHJcbiAgd29yZD86IGJvb2xlYW47XHJcbiAgaWdub3JlQ2FzZT86IGJvb2xlYW47XHJcbiAgcmVnPzogYm9vbGVhbjtcclxuICByZWN1cnNpdmU/OiBib29sZWFuO1xyXG59ID0gbmV3IENvbW1hbmQoJ3NlYXJjaC1pbi1maWxlJylcclxuICAudmVyc2lvbignMy41LjInKVxyXG4gIC5hcmd1bWVudHMoJzx0ZXh0LXRvLXNlYXJjaD4nKVxyXG4gIC51c2FnZSgnPHRleHQtdG8tc2VhcmNoPiBbb3B0aW9uc10nKVxyXG4gIC5hY3Rpb24oKHRleHQpID0+IHtcclxuICAgIHByb2dyYW0udGV4dFRvU2VhcmNoID0gdGV4dDtcclxuICB9KVxyXG4gIC5vbignLS1oZWxwJywgKCkgPT4ge1xyXG4gICAgY29uc29sZS5sb2coKTtcclxuICAgIGNvbnNvbGUubG9nKCdPbmx5IDx0ZXh0LXRvLXNlYXJjaD4gaXMgcmVxdWlyZWQnKTtcclxuICB9KVxyXG4gIC5vcHRpb24oXHJcbiAgICAnLXAsIC0tcGF0aCA8cGF0aD4nLFxyXG4gICAgJ1BhdGgocykgb2YgZmlsZS9kaXJlY3RvcnkgdG8gc2VhcmNoLiBEZWZhdWx0OiBDdXJyZW50IHdvcmtpbmcgZGlyZWN0b3J5JyxcclxuICAgIGNvbmNhdFZhbHVlcyxcclxuICAgIFtdLFxyXG4gIClcclxuICAub3B0aW9uKCctdywgLS13b3JkJywgJ1NlYXJjaCBmb3IgZXhhY3Qgd29yZD8nLCBmYWxzZSlcclxuICAub3B0aW9uKCctaSwgLS1pZ25vcmUtY2FzZScsICdJZ25vcmUgY2FzZSB3aGlsZSBzZWFyY2hpbmc/JywgZmFsc2UpXHJcbiAgLm9wdGlvbignLS1yZWcnLCBgQ29uc2lkZXIgXCJ0ZXh0LXRvLXNlYXJjaFwiIGFzIHJlZ2V4P2AsIGZhbHNlKVxyXG4gIC5vcHRpb24oXHJcbiAgICAnLXIsIC0tcmVjdXJzaXZlJyxcclxuICAgIGBTZWFyY2ggcmVjdXJzaXZlbHkgaW4gc3ViLWRpcmVjdG9yaWVzIG9mIGEgZGlyZWN0b3J5YCxcclxuICAgIGZhbHNlLFxyXG4gIClcclxuICAub3B0aW9uKFxyXG4gICAgJy1lLCAtLWV4Y2x1ZGUtZGlyIDxleGNsdWRlLWRpcj4nLFxyXG4gICAgJ0RpcmVjdG9yeS9maWxlKHMpIHRvIGV4Y2x1ZGUgd2hpbGUgc2VhcmNoaW5nJyxcclxuICAgIGNvbmNhdFZhbHVlcyxcclxuICAgIFtdLFxyXG4gIClcclxuICAub3B0aW9uKFxyXG4gICAgJy1mLCAtLWZpbGUtbWFzayA8ZmlsZS1tYXNrPicsXHJcbiAgICBgU2VhcmNoIGluIGZpbGVzIHdpdGggc3BlY2lmaWMgZXh0ZW5zaW9uLiBFeGFtcGxlOiBcIi50eHRcIiwgXCIuanNcImAsXHJcbiAgKVxyXG4gIC5vcHRpb24oXHJcbiAgICAnLXMsIC0tc2VhcmNoLXJlc3VsdHMgPHR5cGU+JyxcclxuICAgIGBUeXBlIG9mIHNlYXJjaCByZXN1bHQuIFwiZmlsZVBhdGhzXCIvXCJsaW5lTm9cIi4gRGVmYXVsdDogZmlsZVBhdGhzYCxcclxuICAgICdmaWxlUGF0aHMnLFxyXG4gICk7XHJcblxyXG5wcm9ncmFtLnBhcnNlKHByb2Nlc3MuYXJndik7XHJcblxyXG5pZiAoIXByb2dyYW0udGV4dFRvU2VhcmNoKSB7XHJcbiAgY29uc29sZS5sb2coKTtcclxuICBjb25zb2xlLmVycm9yKCdQbGVhc2Ugc3BlY2lmeSB0aGUgdGV4dCB0byBzZWFyY2g6Jyk7XHJcbiAgY29uc29sZS5sb2coYFxcdCR7cHJvZ3JhbS5uYW1lKCl9IDx0ZXh0LXRvLXNlYXJjaD5gKTtcclxuICBjb25zb2xlLmxvZygpO1xyXG4gIGNvbnNvbGUubG9nKCdGb3IgZXhhbXBsZTonKTtcclxuICBjb25zb2xlLmxvZyhgXFx0JHtwcm9ncmFtLm5hbWUoKX0gaGVsbG9gKTtcclxuICBjb25zb2xlLmxvZygpO1xyXG4gIGNvbnNvbGUubG9nKGBSdW4gc2VhcmNoLWluLWZpbGUgLS1oZWxwIHRvIHNlZSBhbGwgb3B0aW9ucy5gKTtcclxuICBwcm9jZXNzLmV4aXQoMSk7XHJcbn1cclxuXHJcbmNvbnN0IHRleHRUb1NlYXJjaCA9IHByb2dyYW0udGV4dFRvU2VhcmNoO1xyXG5jb25zdCBzZWFyY2hSZXN1bHRzID0gcHJvZ3JhbS5nZXRPcHRpb25WYWx1ZSgnc2VhcmNoUmVzdWx0cycpO1xyXG5jb25zdCBwYXRocyA9ICFwcm9ncmFtLmdldE9wdGlvblZhbHVlKCdwYXRoJyk/Lmxlbmd0aCA/IFtwcm9jZXNzLmN3ZCgpXSA6IHByb2dyYW0uZ2V0T3B0aW9uVmFsdWUoJ3BhdGgnKTtcclxuXHJcbmlmIChzZWFyY2hSZXN1bHRzICYmIHNlYXJjaFJlc3VsdHMgIT09ICdmaWxlUGF0aHMnICYmIHNlYXJjaFJlc3VsdHMgIT09ICdsaW5lTm8nKSB7XHJcbiAgY29uc29sZS5sb2coXCJJbnZhbGlkIHZhbHVlIGZvciBhcmd1bWVudCAnLS1zZWFyY2gtcmVzdWx0cydcIik7XHJcbiAgY29uc29sZS5sb2coKTtcclxuICBjb25zb2xlLmxvZyhgUnVuIHNlYXJjaC1pbi1maWxlIC0taGVscCB0byBzZWUgYWxsIG9wdGlvbnMuYCk7XHJcbiAgcHJvY2Vzcy5leGl0KDEpO1xyXG59XHJcblxyXG5jb25zdCBvcHRpb25zID0ge1xyXG4gIHdvcmRzOiBwcm9ncmFtLmdldE9wdGlvblZhbHVlKCd3b3JkJyksXHJcbiAgaWdub3JlQ2FzZTogcHJvZ3JhbS5nZXRPcHRpb25WYWx1ZSgnaWdub3JlQ2FzZScpLFxyXG4gIGlzUmVnZXg6IHByb2dyYW0uZ2V0T3B0aW9uVmFsdWUoJ3JlZycpLFxyXG4gIHJlY3Vyc2l2ZTogcHJvZ3JhbS5nZXRPcHRpb25WYWx1ZSgncmVjdXJzaXZlJyksXHJcbiAgaWdub3JlRGlyOiBwcm9ncmFtLmdldE9wdGlvblZhbHVlKCdleGNsdWRlRGlyJyksXHJcbiAgZmlsZU1hc2s6IHByb2dyYW0uZ2V0T3B0aW9uVmFsdWUoJ2ZpbGVNYXNrJyksXHJcbiAgc2VhcmNoUmVzdWx0czogcHJvZ3JhbS5nZXRPcHRpb25WYWx1ZSgnc2VhcmNoUmVzdWx0cycpLFxyXG59O1xyXG5cclxuZmlsZVNlYXJjaChwYXRocywgdGV4dFRvU2VhcmNoLCBvcHRpb25zKVxyXG4gIC50aGVuKChyZXMpID0+IHtcclxuICAgIGlmICghcmVzLmxlbmd0aCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIHJlc3VsdHMgZm91bmQuJyk7XHJcbiAgICB9XHJcbiAgICBpZiAocHJvZ3JhbS5zZWFyY2hSZXN1bHRzID09PSAnbGluZU5vJykge1xyXG4gICAgICByZXMuZm9yRWFjaCgocikgPT4ge1xyXG4gICAgICAgIGlmIChyLmxlbmd0aCkge1xyXG4gICAgICAgICAgY29uc3QgW2ZpcnN0RWxlbV0gPSByIGFzIExpbmVSZXN1bHRbXTtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKCk7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhgZmlsZVBhdGg6ICR7Zmlyc3RFbGVtLmZpbGVQYXRofWApO1xyXG4gICAgICAgICAgY29uc29sZS50YWJsZShyLCBbJ2xpbmUnLCAnbGluZU5vJ10pO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjb25zb2xlLnRhYmxlKHJlcyk7XHJcbiAgICB9XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycjogRXJyb3IpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgfSk7XHJcbiJdfQ==